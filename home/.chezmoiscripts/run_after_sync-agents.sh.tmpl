{{ if ne .chezmoi.os "windows" -}}
#!/bin/bash
# Auto-add any new Claude Code agent files to chezmoi

sync_agents_dir() {
    local dir="$1"
    [ -d "$dir" ] || return 0

    # Add all .md files in agents directory
    for agent in "$dir"/*.md; do
        [ -f "$agent" ] || continue
        chezmoi add "$agent" 2>/dev/null || true
    done

    # Add all files in agents/skills directory
    if [ -d "$dir/skills" ]; then
        for skill in "$dir/skills"/*; do
            [ -f "$skill" ] || continue
            chezmoi add "$skill" 2>/dev/null || true
        done
    fi
}

sync_agents_dir "$HOME/.claude/agents"
sync_agents_dir "$HOME/.agents"
{{- end }}

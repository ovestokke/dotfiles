{{ if ne .chezmoi.os "windows" -}}
#!/bin/bash
set -euo pipefail

# extensions.txt hash: {{ includeTemplate "vscode/extensions.txt" . | sha256sum }}

if ! command -v code &> /dev/null; then
    echo "VS Code CLI not found, skipping extension installation"
    exit 0
fi

echo "Installing VS Code extensions..."

while IFS= read -r extension; do
    # Skip empty lines and comments
    if [ -n "$extension" ] && [[ ! "$extension" =~ ^# ]]; then
        echo "Installing: $extension"
        code --install-extension "$extension" --force
    fi
done <<'EOF'
{{ includeTemplate "vscode/extensions.txt" . }}
EOF

echo "VS Code extensions installed"
{{- end }}

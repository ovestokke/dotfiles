{{- if eq .chezmoi.os "windows" }}
# Auto-add any new Claude Code agent files to chezmoi

function Sync-AgentsDir {
    param([string]$Dir)

    if (-not (Test-Path $Dir)) { return }

    # Add all .md files in agents directory
    Get-ChildItem -Path $Dir -Filter "*.md" -ErrorAction SilentlyContinue | ForEach-Object {
        chezmoi add $_.FullName 2>$null
    }

    # Add all files in agents/skills directory
    $skillsDir = Join-Path $Dir "skills"
    if (Test-Path $skillsDir) {
        Get-ChildItem -Path $skillsDir -File -ErrorAction SilentlyContinue | ForEach-Object {
            chezmoi add $_.FullName 2>$null
        }
    }
}

Sync-AgentsDir (Join-Path $env:USERPROFILE ".claude\agents")
Sync-AgentsDir (Join-Path $env:USERPROFILE ".agents")
{{- end }}

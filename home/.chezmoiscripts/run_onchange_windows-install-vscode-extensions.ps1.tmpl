{{- if eq .chezmoi.os "windows" }}
# extensions.txt hash: {{ includeTemplate "vscode/extensions.txt" . | sha256sum }}

if (-not (Get-Command code -ErrorAction SilentlyContinue)) {
    Write-Host "VS Code CLI not found, skipping extension installation"
    exit 0
}

Write-Host "Installing VS Code extensions..."

@'
{{ includeTemplate "vscode/extensions.txt" . }}
'@ -split "`n" | ForEach-Object {
    # Strip inline comments and trim
    $extension = ($_ -replace '#.*$','').Trim()
    # Skip empty lines
    if ($extension) {
        Write-Host "Installing: $extension"
        code --install-extension $extension --force
    }
}

Write-Host "VS Code extensions installed"
{{- end }}
